<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
    <head></head>
    <body>
<h1>@depends</h1>
<p>
PHPUnit supports the declaration of explicit dependencies between test methods.
Such dependencies do not define the order in which the test methods are to be
executed but they allow the returning of an instance of the test fixture by a
producer and passing it to the dependent consumers.
</p>
<p>
A producer is a test method that yields its unit under test as return value.
</p>
<p>
A consumer is a test method that depends on one or more producers and their return values.
</p>
  <pre class="programlisting"><code><span class="default">&lt;?php</span><br><span class="keyword">class</span><span class="default"> </span><span class="default">StackTest</span><span class="default"> </span><span class="keyword">extends</span><span class="default"> </span><span class="default">PHPUnit_Framework_TestCase</span><br><span class="keyword">{</span><br><span class="default">    </span><span class="keyword">public</span><span class="default"> </span><span class="keyword">function</span><span class="default"> </span><span class="default">testEmpty</span><span class="keyword">(</span><span class="keyword">)</span><br><span class="default">    </span><span class="keyword">{</span><br><span class="default">        </span><span class="default">$stack</span><span class="default"> </span><span class="keyword">=</span><span class="default"> </span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br><span class="default">        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEmpty</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)</span><span class="keyword">;</span><br> <br><span class="default">        </span><span class="keyword">return</span><span class="default"> </span><span class="default">$stack</span><span class="keyword">;</span><br><span class="default">    </span><span class="keyword">}</span><br> <br><span class="default">    </span><span class="comment">/**</span><br><span class="comment">     * @depends testEmpty</span><br><span class="comment">     */</span><br><span class="default">    </span><span class="keyword">public</span><span class="default"> </span><span class="keyword">function</span><span class="default"> </span><span class="default">testPush</span><span class="keyword">(</span><span class="keyword">array</span><span class="default"> </span><span class="default">$stack</span><span class="keyword">)</span><br><span class="default">    </span><span class="keyword">{</span><br><span class="default">        </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">,</span><span class="default"> </span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br><span class="default">        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default"> </span><span class="default">$stack</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]</span><span class="keyword">)</span><span class="keyword">;</span><br><span class="default">        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertNotEmpty</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)</span><span class="keyword">;</span><br> <br><span class="default">        </span><span class="keyword">return</span><span class="default"> </span><span class="default">$stack</span><span class="keyword">;</span><br><span class="default">    </span><span class="keyword">}</span><br> <br><span class="default">    </span><span class="comment">/**</span><br><span class="comment">     * @depends testPush</span><br><span class="comment">     */</span><br><span class="default">    </span><span class="keyword">public</span><span class="default"> </span><span class="keyword">function</span><span class="default"> </span><span class="default">testPop</span><span class="keyword">(</span><span class="keyword">array</span><span class="default"> </span><span class="default">$stack</span><span class="keyword">)</span><br><span class="default">    </span><span class="keyword">{</span><br><span class="default">        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default"> </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br><span class="default">        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEmpty</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)</span><span class="keyword">;</span><br><span class="default">    </span><span class="keyword">}</span><br><span class="keyword">}</span><br><span class="default">?&gt;</span><br></code>
 <p>
In the example above, the first test, <code class="literal">testEmpty()</code>,
creates a new array and asserts that it is empty. The test then returns the fixture as its result.
 The second test, <code class="literal">testPush()</code>, depends on <code class="literal">testEmpty()</code>
and is passed the result of that depended-upon test as its argument. Finally, <code class="literal">testPop()</code>
depends upons <code class="literal">testPush()</code>.
</p>
<pre class="programlisting"><code><span class="default">&lt;?php</span><br><span class="keyword">class</span><span class="default"> </span><span class="default">DependencyFailureTest</span><span class="default"> </span><span class="keyword">extends</span><span class="default"> </span><span class="default">PHPUnit_Framework_TestCase</span><br><span class="keyword">{</span><br><span class="default">    </span><span class="keyword">public</span><span class="default"> </span><span class="keyword">function</span><span class="default"> </span><span class="default">testOne</span><span class="keyword">(</span><span class="keyword">)</span><br><span class="default">    </span><span class="keyword">{</span><br><span class="default">        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">FALSE</span><span class="keyword">)</span><span class="keyword">;</span><br><span class="default">    </span><span class="keyword">}</span><br> <br><span class="default">    </span><span class="comment">/**</span><br><span class="comment">     * @depends testOne</span><br><span class="comment">     */</span><br><span class="default">    </span><span class="keyword">public</span><span class="default"> </span><span class="keyword">function</span><span class="default"> </span><span class="default">testTwo</span><span class="keyword">(</span><span class="keyword">)</span><br><span class="default">    </span><span class="keyword">{</span><br><span class="default">    </span><span class="keyword">}</span><br><span class="keyword">}</span><br><span class="default">?&gt;</span><br></code>
 <p>
A test may have more than one <code class="literal">@depends</code> annotation.
PHPUnit does not change the order in which tests are executed, you have to ensure that
the dependencies of a test can actually be met before the test is run.
</p>
</body>
</html>